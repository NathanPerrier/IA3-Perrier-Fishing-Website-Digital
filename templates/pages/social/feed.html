{% extends 'layouts/base-alt.html' %}
{% load static %}
{% load humanize %}
{% load list_filters %}

{% block extrastyle %}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.bubble.css" />
    <!--<link href="{% static 'assets\quill.css' %}" rel="stylesheet" />-->
{% endblock extrastyle %}


{% block content %}
{% load list_filters %}
<section class="bg-white dark:bg-gray-900 h-screen flex justify-center items-center pt-20">
    <div class="py-8 px-4 mx-auto my-auto max-w-screen-xl text-center lg:py-16 lg:px-12">
        <a href="#feed" class="inline-flex justify-between items-center py-1 px-1 pr-4 text-sm text-gray-700 bg-gray-200 rounded-full dark:bg-gray-800 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-700 mb-8 animate__animated animate__fadeIn animate__delay-1s" role="alert">
            <span class="text-xs bg-primary-600 rounded-full text-white px-4 py-1.5 mr-3">Fishing</span> <span class="text-sm font-medium">See what our fishing club is up to!</span> 
            <svg class="ml-2 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg>
        </a>
        <h1 class="mb-4 text-4xl font-extrabold tracking-tight leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white animate__animated animate__zoomInDown">Welcome To Our "Brag Page"</h1>
        <p class="mb-8 text-lg font-normal text-gray-500 lg:text-xl sm:px-16 xl:px-48 dark:text-gray-400">Learn about what we get up to at the Ambrose Treacy College fishing club as our members "brag" about their recent catches. To stay up to date ensure to follow any members to be notified of when they post!</p>
        <div class="lg:col-span-7 mb-8 lg:mb-16 py-2 flex flex-row justify-center sm:space-y-0 space-x-4">
            <a href="/social/post/" class="inline-flex mt-0 justify-center items-center py-3 px-5 text-base font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-900">
                Create a Post
                <svg class="ml-2 -mr-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </a>
            <a href="#feed" class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-gray-900 rounded-lg border border-gray-300 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700 dark:focus:ring-gray-800">
                <svg class="mr-2 -ml-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"></path></svg>
                View Feed
            </a>  
        </div>
        <div class="px-4 mb-2 mx-auto text-center md:max-w-screen-md lg:max-w-screen-lg lg:px-36">
            <div class="flex flex-wrap justify-center items-center mt-8 text-gray-500 sm:justify-between -z-50">
                <div id="default-carousel" class="relative w-full h-14 lg:h-8 -z-20" data-carousel="slide">
                    <!-- Carousel wrapper -->
                    <div class="relative h-full overflow-hidden rounded-lg">
                        {% for fish in fishes %}
                            <!-- Item 1 -->
                            <div class="hidden duration-2000 ease-in-out h-full -z-40" data-carousel-item>
                                <!--https://source.unsplash.com/?fish=-->
                                {{fish.common_name|title}}
                                <span class="ms-6">{{ fishes|get_item:forloop.counter|default:""|title }}</span>
                                {% with counter=forloop.counter|add:1 %}
                                    <span class="ms-6">{{ fishes|get_item:counter|default:""|title }}</span>
                                {% endwith %}
                                {% with counter2=forloop.counter|add:2 %}
                                    <span class="ms-6">{{ fishes|get_item:counter2|default:""|title }}</span>
                                {% endwith %}
                            </div>
                        {% endfor %}
                    </div>              
                </div> 
            </div>
        </div> 
    </div>
</section>


<section id="feed" class="bg-gray-200 dark:bg-gray-700 pt-20 p-3 py-8 w-screen">
    <div class="grid grid-cols gap-6 mx-auto sm:grid-cols-1 lg:grid-cols-3 px-2 lg:px-8 w-screen">
        <div class="col-span-2">
            <div class="grid grid-cols-1 gap-6 mx-auto sm:grid-cols-1 lg:grid-cols-1 lg:px-12 w-screen">
                {% for post in posts %}
                    {% if post.images %}
                        <div class="w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
                            <div id="indicators-carousel" class="relative w-full" data-carousel="static">
                                <!-- Carousel wrapper -->
                                <div class="relative overflow-hidden rounded-t-lg h-56 md:h-96">
                                        <!-- Item 1 -->
                                    {% for image in post.images %}
                                        {% if image.image.url|image_exists %}
                                            <div class="hidden duration-700 ease-in-out" data-carousel-item="active">
                                                <img src="{{image.image.url}}" class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2 object-fill h-full" alt="...">
                                            </div>
                                        {% else %}
                                            <div class="hidden duration-700 animate-pulse ease-in-out border-2 rounded-t-lg border-white dark:border-gray-800 bg-gray-300 dark:bg-gray-700 items-center justify-center" data-carousel-item="active">
                                                <div class="w-full flex item-center justify-center absolute" style="top:40%">
                                                    <svg class="w-20 h-20 text-gray-200 dark:text-gray-600" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 18">
                                                        <path d="M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"/>
                                                    </svg>
                                                </div>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                   
                                </div>
                                <!-- Slider indicators -->
                                {% if post.images|length > 1%}
                                    <div class="absolute z-30 flex -translate-x-1/2 space-x-3 rtl:space-x-reverse bottom-5 left-1/2">
                                        
                                        {% for image in post.images %}
                                            <button type="button" class="w-3 h-3 rounded-full" aria-current="true" aria-label="Slide {{forloop.counter|add:1}}" data-carousel-slide-to="{{forloop.counter}}"></button>
                                        {% endfor %}
                    
                                    </div>
                                    <!-- Slider controls -->
                                    <button type="button" class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
                                        <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                                            <svg class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
                                            </svg>
                                            <span class="sr-only">Previous</span>
                                        </span>
                                    </button>
                                    <button type="button" class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
                                        <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 dark:bg-gray-800/30 group-hover:bg-white/50 dark:group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                                            <svg class="w-4 h-4 text-white dark:text-gray-800 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
                                            </svg>
                                            <span class="sr-only">Next</span>
                                        </span>
                                    </button>
                                {% endif %}
                            </div>
        
                            <div class="p-5">
                                <!-- like, comment save icons -->
                                <div class="flex items mb-3">
                                    <div class="flex items-center">
                                        <a href="/social/feed/{{post.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                            {% if post.liked %}
                                                <i class="fa fa-heart"></i>
                                            {% else %}
                                                <i class="fa-regular fa-heart"></i> <!--not liked-->
                                            {% endif %}
                                        </a>
                                        <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                        <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{post.likes|length}} likes</small>
                                    </div>
                                    <button onclick="document.getElementById('comments-form-{{post.id}}').classList.remove('hidden')" class="flex items-center justify-center w-8 h-8 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none ms-2">
                                        <i class="fa-regular fa-comment"></i>
                                    </button>
                                    <div class="ms-auto right-0 flex items-center">
                                        {% if request.user.is_superuser or request.user.is_staff %}
                                            <a href="/admin/social/post/{{post.id}}/change/" class="flex items-center hover:underline justify-center text-gray-500 focus:outline-none me-3">Manage</a>
                                            <span class="font-bold mb-2 text-gray-500 me-1">.</span>
                                        {% endif %}
                                        <a href="/social/feed/{{post.id}}/save/" class="flex items-center justify-center w-8 h-8 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                            {% if post.saved %}
                                                <i class="fa fa-bookmark"></i>
                                            {% else %}
                                                <i class="fa-regular fa-bookmark"></i>
                                            {% endif %}
                                        </a>
                                    </div>
                                </div>
                                <div class="flex items-center mb-3">
                                    <a href="/users/profile/{{post.user_profile.user.username}}">
                                        {% if post.user_profile.avatar %}
                                            <img class="w-10 h-10 rounded-full" src="{{ post.user_profile.avatar.url }}" alt="User" />
                                        {% else %}
                                            <img class="w-10 h-10 rounded-full" src="{% static "dist/img/default-user.png" %}" alt="User" />
                                        {% endif %}
                                    </a>
                                    <div class="ms-3">
                                        <a href="/users/profile/{{post.user_profile.user.username}}" class="font-semibold text-gray-900 dark:text-white">{{post.user_profile.user.username}}</a>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">{{ post.created_at|naturaltime }}</p>
                                    </div>
                                    {% if request.user.profile == post.user_profile %}
                                        <a href="/social/feed/{{post.id}}/edit" class="focus:ring-4 font-medium text-sm px-5 py-2.5 text-center inline-flex items-center  border dark:text-white text-gray-800 rounded-lg ms-auto right-0">Edit</a>
                                    {% else %}
                                        {% if post.is_following %}
                                            <a href="/users/profile/{{post.user_profile.user.username}}/unfollow" class="focus:ring-4 font-medium text-sm px-5 py-2.5 text-center inline-flex items-center  border border-gray-600 text-gray-600 dark:text-white rounded-lg ms-auto right-0">Unfollow</a>
                                        {% else %}
                                            <a href="/users/profile/{{post.user_profile.user.username}}/follow" class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 ms-auto right-0">Follow</a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                                <div class="mb-3 font-normal text-gray-700 dark:text-gray-400" id="postText-{{post.id}}"></div>
                                <script>
                                    var quill{{post.id}} = new Quill('#postText-{{post.id}}', {
                                        theme: 'bubble',
                                        readOnly: true  // Add this if you want the editor to be read-only
                                    });
                                    var delta = {{ post.content|safe}};
                                    quill{{post.id}}.setContents(delta);
                                </script>
                                {% if post.species %}
                                    <div class="rounded-lg bg-gray-200 dark:bg-gray-700">
                                        <div class="p-2 flex items">
                                            <img class="w-20 h-12 rounded" src="https://source.unsplash.com/featured/?fish={{post.species.common_name}}" alt="Fish Species" />
                                            <div class="ms-3">
                                                <p class="font-semibold text-gray-900 dark:text-white bold">{{ post.species.common_name }}</p>
                                                <small class="text-sm text-gray-500 dark:text-gray-400">{{ post.species.name }}</small>
                                            </div>
                                            <div class="ms-auto right-0">
                                                <a href="https://biodiversity.org.au/afd/taxa/{{post.species.name|replace_spaces}}" target="_blank" class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-4 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 ms-auto right-0">View</a>
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                                {% if post.comments %}
                                    <div class="pt-4">
                                        <a onclick="document.getElementById('comments-{{post.id}}').classList.remove('hidden')" class="text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline">View all {{ post.comments|length }} comments</a>
                                    </div>
                                {% endif %}
                                <form class="mb-2 mt-4 hidden" action="/social/feed/{{post.id}}/comment/" method="POST" id="comments-form-{{post.id}}"> <!-- comment-form-{post.id}-->
                                    {% csrf_token %}
                                    <div class="py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
                                        <label for="comment" class="sr-only">Your comment</label>
                                        <textarea id="comment" name="content" rows="3"
                                            class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800"
                                            placeholder="Write a comment..." required></textarea>
                                    </div>
                                    <div class="flex items">
                                        <button type="submit"
                                            class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                                            Post comment
                                        </button>
                                        <button type="button" onclick="document.getElementById('comments-form-{{post.id}}').classList.add('hidden')"
                                            class="text-white bg-red-500 dark:bg-red-600 dark:hover:bg-red-400 focus:ring-2 focus:ring-red-400 font-medium rounded-lg text-sm px-5 py-2.5 flex ms-auto right-0">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                                <div class="space-y-4 hidden" id="comments-{{post.id}}"> <!-- comments-{post.id} -->   
                                    <div class="flex items-center mx-auto justify-center">
                                        <button type="button" onclick="document.getElementById('comments-{{post.id}}').classList.add('hidden')">
                                            <i class="fa-regular fa-arrow-alt-circle-up fa-2x text-primary-800 dark:text-white"></i>
                                        </button>
                                    </div>
                                    {% for comment in post.comments %}
                                        <article class="p-6 text-base bg-gray-200 rounded-lg dark:bg-gray-700" id="comments-{{post.id}}-comment-{{comment.id}}"> <!-- comments-{comment.post.id}-comment-{comment.id}-->
                                            <footer class="flex justify-between items-center mb-2">
                                                <div class="flex items-center">
                                                    <p class="inline-flex items-center mr-3 text-sm text-gray-900 dark:text-white font-semibold">
                                                        {% if comment.user_profile.avatar%}
                                                            <img
                                                            class="mr-2 w-6 h-6 rounded-full"
                                                            src="{{ comment.user_profile.avatar.url }}"
                                                            alt="Michael Gough">
                                                        {% else %}
                                                            <img
                                                                class="mr-2 w-6 h-6 rounded-full"
                                                                src="{% static "dist/img/default-user.png" %}"
                                                                alt="Michael Gough">
                                                        {% endif %}
                                                        {{comment.user_profile.user.username}}
                                                    </p>
                                                    <p class="text-sm text-gray-600 dark:text-gray-400">{{comment.created_at|naturaltime}}</p>
                                                </div>
                                                <button id="dropdownComment1Button" data-dropdown-toggle="dropdownComment1"
                                                    class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 dark:text-gray-400 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                                                    type="button">
                                                    <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                                                        <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                                                    </svg>
                                                    <span class="sr-only">Comment settings</span>
                                                </button>
                                                <!-- Dropdown menu -->
                                                <div id="dropdownComment1"
                                                    class="hidden z-10 w-36 bg-white rounded divide-y divide-gray-100 shadow dark:bg-gray-700 dark:divide-gray-600">
                                                    <ul class="py-1 text-sm text-gray-700 dark:text-gray-200"
                                                        aria-labelledby="dropdownMenuIconHorizontalButton">
                                                        {% if request.user.profile == comment.user_profile or request.user.is_superuser %}
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Edit</a>
                                                        </li>
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Remove</a>
                                                        </li>
                                                        {% endif %}
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Report</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </footer>
                                            <p class="text-gray-500 dark:text-gray-400">{{comment.content}}</p>
                                            <div class="flex items-center mt-4 space-x-4">
                                                <div class="flex items-center">
                                                    <a href="/social/feed/{{post.id}}/comment/{{comment.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                                        {% if comment.liked %}
                                                            <i class="fa fa-heart"></i>
                                                        {% else %}
                                                            <i class="fa-regular fa-heart"></i> <!--not liked-->
                                                        {% endif %}
                                                    </a>
                                                    <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                                    <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{comment.likes|length}} likes</small>
                                                </div>
                                                <a onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-form').classList.remove('hidden')"
                                                    class="flex items-center text-sm text-gray-500 hover:underline dark:text-gray-400 text-sm text-gray-500 hover:underline dark:text-gray-400">
                                                    <svg class="mr-1.5 w-3.5 h-3.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 18">
                                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5h5M5 8h2m6-3h2m-5 3h6m2-7H2a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h3v5l5-5h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1Z"/>
                                                    </svg>
                                                    Reply
                                                </a>
                                            </div>
                                            {% if comment.comments %}
                                                <div class="mt-2">
                                                    <a onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-nested').classList.remove('hidden')" class="text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline">View all {{comment.comments|length}} replies</a>
                                                </div>
                                            {% endif %}
                                            <form class="mt-4 hidden" action="/social/feed/{{post.id}}/comment/{{comment.id}}/comment/" method="POST" id="comments-{{post.id}}-comment-{{comment.id}}-form"> <!-- comment-form-{post.id}-->
                                                {% csrf_token %}
                                                <div class="py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
                                                    <label for="comment" class="sr-only">Your Relpy</label>
                                                    <textarea id="comment" name="content" rows="3"
                                                        class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800"
                                                        placeholder="Write a comment..." required></textarea>
                                                </div>
                                                <div class="flex items">
                                                    <button type="submit"
                                                        class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                                                        Post Reply
                                                    </button>
                                                    <button type="button" onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-form').classList.add('hidden')"
                                                        class="text-white bg-red-500 dark:bg-red-600 dark:hover:bg-red-400 focus:ring-2 focus:ring-red-400 font-medium rounded-lg text-sm px-5 py-2.5 flex ms-auto right-0">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </form>
                                        </article>
                                        {% if comment.comments %}
                                            <div class="hidden" id="comments-{{post.id}}-comment-{{comment.id}}-nested">  <!-- nested -->
                                                <div class="flex items-center mx-auto justify-center mb-2">
                                                    <button type="button" onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-nested').classList.add('hidden')">
                                                        <i class="fa-regular fa-arrow-alt-circle-up fa-2x text-primary-800 dark:text-white"></i>
                                                    </button>
                                                </div>
                                            {% for nested_comment in comment.comments %}
                                                
                                                <article class="p-6 mb-3 ml-6 lg:ml-12 text-base bg-gray-200 rounded-lg dark:bg-gray-700"> <!-- comments-{comment.post.id}-comment-{comment.id}-nested-{comment_nested.id} -->
                                                    <footer class="flex justify-between items-center mb-2">
                                                        <div class="flex items-center">
                                                            <p class="inline-flex items-center mr-3 text-sm text-gray-900 dark:text-white font-semibold">
                                                                {% if nested_comment.user_profile.avatar%}
                                                                    <img
                                                                    class="mr-2 w-6 h-6 rounded-full"
                                                                    src="{{ nested_comment.user_profile.avatar.url }}"
                                                                    alt="Michael Gough">
                                                                {% else %}
                                                                    <img
                                                                        class="mr-2 w-6 h-6 rounded-full"
                                                                        src="{% static "dist/img/default-user.png" %}"
                                                                        alt="Michael Gough">
                                                                {% endif %}
                                                                {{nested_comment.user_profile.user.username}}
                                                            </p>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400"><time pubdate datetime="2022-02-12"
                                                                    title="February 12th, 2022">{{nested_comment.created_at|naturaltime}}</time></p>
                                                        </div>
                                                        <button id="dropdownComment2Button" data-dropdown-toggle="dropdownComment2"
                                                            class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 dark:text-gray-40 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                                                            type="button">
                                                            <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                                                                <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                                                            </svg>
                                                            <span class="sr-only">Comment settings</span>
                                                        </button>
                                                        <!-- Dropdown menu -->
                                                        <div id="dropdownComment2"
                                                            class="hidden z-10 w-36 bg-white rounded divide-y divide-gray-100 shadow dark:bg-gray-700 dark:divide-gray-600">
                                                            <ul class="py-1 text-sm text-gray-700 dark:text-gray-200"
                                                                aria-labelledby="dropdownMenuIconHorizontalButton">
                                                                {% if request.user.profile == nested_comment.user_profile or request.user.is_superuser %}
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Edit</a>
                                                                </li>
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Remove</a>
                                                                </li>
                                                                {% endif %}
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Report</a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </footer>
                                                    <p class="text-gray-500 dark:text-gray-400">{{ nested_comment.content}}</p>
                                                    <div class="flex items-center mt-4 space-x-4">
                                                        <div class="flex items-center">
                                                            <a href="/social/feed/{{post.id}}/comment/{{nested_comment.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                                                {% if nested_comment.liked %}
                                                                    <i class="fa fa-heart"></i>
                                                                {% else %}
                                                                    <i class="fa-regular fa-heart"></i> <!--not liked-->
                                                                {% endif %}
                                                            </a>
                                                            <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                                            <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{nested_comment.likes|length}} likes</small>
                                                        </div>
                                                    </div>
                                                </article>
                                            {% endfor %}
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="w-full bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
                            <div class="p-5">
                                <div class="flex items-center mb-3">
                                    <a href="/users/profile/{{post.user_profile.user.username}}">
                                        {% if post.user_profile.avatar %}
                                            <img class="w-10 h-10 rounded-full" src="{{ post.user_profile.avatar.url }}" alt="User" />
                                        {% else %}
                                            <img class="w-10 h-10 rounded-full" src="{% static "dist/img/default-user.png" %}" alt="User" />
                                        {% endif %}
                                    </a>
                                    <div class="ms-3">
                                        <a href="/users/profile/{{post.user_profile.user.username}}" class="font-semibold text-gray-900 dark:text-white">{{post.user_profile.user.username}}</a>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">{{ post.created_at|naturaltime }}</p>
                                    </div>
                                    {% if request.user.profile == post.user_profile %}
                                        <a href="/social/feed/{{post.id}}/edit" class="focus:ring-4 font-medium text-sm px-5 py-2.5 text-center inline-flex items-center  border dark:text-white text-gray-800 rounded-lg ms-auto right-0">Edit</a>
                                    {% else %}
                                        {% if post.is_following %}
                                            <a href="/users/profile/{{post.user_profile.user.username}}/unfollow" class="focus:ring-4 font-medium text-sm px-5 py-2.5 text-center inline-flex items-center  border border-gray-600 text-gray-600 dark:text-white rounded-lg ms-auto right-0">Unfollow</a>
                                        {% else %}
                                            <a href="/users/profile/{{post.user_profile.user.username}}/follow" class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 ms-auto right-0">Follow</a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                                <div class="mb-3 font-normal text-gray-700 dark:text-gray-400" id="postText-{{post.id}}"></div>
                                <script>
                                    var quill{{post.id}} = new Quill('#postText-{{post.id}}', {
                                        theme: 'bubble',
                                        readOnly: true  // Add this if you want the editor to be read-only
                                    });
                                    var delta = {{ post.content|safe}};
                                    quill{{post.id}}.setContents(delta);
                                </script>
                                {% if post.species %}
                                    <div class="rounded-lg bg-gray-200 dark:bg-gray-700">
                                        <div class="p-2 flex items">
                                            <img class="w-20 h-12 rounded" src="https://source.unsplash.com/featured/?fish=whiting" alt="Fish Species" />
                                            <div class="ms-3">
                                                <p class="font-semibold text-gray-900 dark:text-white bold">{{ post.species.common_name }}</p>
                                                <small class="text-sm text-gray-500 dark:text-gray-400">{{ post.species.name }}</small>
                                            </div>
                                            <div class="ms-auto right-0">
                                                <a href="https://biodiversity.org.au/afd/taxa/{{post.species.name|replace_spaces}}" target="_blank" class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-4 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 ms-auto right-0">View</a>
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                                <div class="flex items my-2">
                                    <div class="flex items-center">
                                        <a href="/social/feed/{{post.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                            {% if post.liked %}
                                                <i class="fa fa-heart"></i>
                                            {% else %}
                                                <i class="fa-regular fa-heart"></i> <!--not liked-->
                                            {% endif %}
                                        </a>
                                        <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                        <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{post.likes|length}} likes</small>
                                    </div>
                                    <button onclick="document.getElementById('comments-form-{{post.id}}').classList.remove('hidden')"  class="flex items-center justify-center w-8 h-8 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none ms-2">
                                        <i class="fa-regular fa-comment"></i>
                                    </button>
                                    <div class="ms-auto right-0 flex items-center">
                                        {% if request.user.is_superuser or request.user.is_staff %}
                                            <a href="/admin/social/post/{{post.id}}/change/" class="flex items-center hover:underline justify-center text-gray-500 focus:outline-none me-3">Manage</a>
                                            <span class="font-bold mb-2 text-gray-500 me-1">.</span>
                                        {% endif %}
                                        <a href="/social/feed/{{post.id}}/save/" class="flex items-center justify-center w-8 h-8 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                            {% if post.saved %}
                                                <i class="fa fa-bookmark"></i>
                                            {% else %}
                                                <i class="fa-regular fa-bookmark"></i>
                                            {% endif %}
                                        </a>
                                    </div>
                                </div>
                                {% if post.comments %}
                                    <div class="">
                                        <a onclick="document.getElementById('comments-{{post.id}}').classList.remove('hidden')" class="text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline">View all {{ post.comments|length }} comments</a>
                                    </div>
                                {% endif %}
                                <form class="mb-2 mt-4 hidden" action="/social/feed/{{post.id}}/comment/" method="POST" id="comments-form-{{post.id}}"> <!-- comment-form-{post.id}-->
                                    {% csrf_token %}
                                    <div class="py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
                                        <label for="comment" class="sr-only">Your comment</label>
                                        <textarea id="comment" name="content" rows="3"
                                            class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800"
                                            placeholder="Write a comment..." required></textarea>
                                    </div>
                                    <div class="flex items">
                                        <button type="submit"
                                            class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                                            Post comment
                                        </button>
                                        <button type="button" onclick="document.getElementById('comments-form-{{post.id}}').classList.add('hidden')"
                                            class="text-white bg-red-500 dark:bg-red-600 dark:hover:bg-red-400 focus:ring-2 focus:ring-red-400 font-medium rounded-lg text-sm px-5 py-2.5 flex ms-auto right-0">
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                                <div class="space-y-4 hidden" id="comments-{{post.id}}"> <!-- comments-{post.id} -->   
                                    <div class="flex items-center mx-auto justify-center">
                                        <button type="button" onclick="document.getElementById('comments-{{post.id}}').classList.add('hidden')">
                                            <i class="fa-regular fa-arrow-alt-circle-up fa-2x text-primary-800 dark:text-white"></i>
                                        </button>
                                    </div>
                                    {% for comment in post.comments %}
                                        <article class="p-6 text-base bg-gray-200 rounded-lg dark:bg-gray-700" id="comments-{{post.id}}-comment-{{comment.id}}"> <!-- comments-{comment.post.id}-comment-{comment.id}-->
                                            <footer class="flex justify-between items-center mb-2">
                                                <div class="flex items-center">
                                                    <p class="inline-flex items-center mr-3 text-sm text-gray-900 dark:text-white font-semibold">
                                                        {% if comment.user_profile.avatar%}
                                                            <img
                                                            class="mr-2 w-6 h-6 rounded-full"
                                                            src="{{ comment.user_profile.avatar.url }}"
                                                            alt="Michael Gough">
                                                        {% else %}
                                                            <img
                                                                class="mr-2 w-6 h-6 rounded-full"
                                                                src="{% static "dist/img/default-user.png" %}"
                                                                alt="Michael Gough">
                                                        {% endif %}
                                                        {{ comment.user_profile.user.username }}
                                                    </p>
                                                    <p class="text-sm text-gray-600 dark:text-gray-400"><time pubdate datetime="2022-02-08"
                                                            title="February 8th, 2022">{{comment.created_at|naturaltime}}</time></p>
                                                </div>
                                                <button id="dropdownComment1Button" data-dropdown-toggle="dropdownComment1"
                                                    class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 dark:text-gray-400 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                                                    type="button">
                                                    <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                                                        <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                                                    </svg>
                                                    <span class="sr-only">Comment settings</span>
                                                </button>
                                                <!-- Dropdown menu -->
                                                <div id="dropdownComment1"
                                                    class="hidden z-10 w-36 bg-white rounded divide-y divide-gray-100 shadow dark:bg-gray-700 dark:divide-gray-600">
                                                    <ul class="py-1 text-sm text-gray-700 dark:text-gray-200"
                                                        aria-labelledby="dropdownMenuIconHorizontalButton">
                                                        {% if request.user.profile == comment.user_profile or request.user.is_superuser %}
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Edit</a>
                                                        </li>
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Remove</a>
                                                        </li>
                                                        {% endif %}
                                                        <li>
                                                            <a href="#"
                                                                class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Report</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </footer>
                                            <p class="text-gray-500 dark:text-gray-400">{{comment.content}}</p>
                                            <div class="flex items-center mt-4 space-x-4">
                                                <div class="flex items-center">
                                                    <a href="/social/feed/{{post.id}}/comment/{{comment.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                                        {% if comment.liked %}
                                                            <i class="fa fa-heart"></i>
                                                        {% else %}
                                                            <i class="fa-regular fa-heart"></i> <!--not liked-->
                                                        {% endif %}
                                                    </a>
                                                    <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                                    <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{comment.likes|length}} likes</small>
                                                </div>
                                                <a onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-form').classList.remove('hidden')"
                                                    class="flex items-center text-sm text-gray-500 hover:underline dark:text-gray-400 text-sm text-gray-500 hover:underline dark:text-gray-400">
                                                    <svg class="mr-1.5 w-3.5 h-3.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 18">
                                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5h5M5 8h2m6-3h2m-5 3h6m2-7H2a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h3v5l5-5h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1Z"/>
                                                    </svg>
                                                    Reply
                                                </a>
                                            </div>
                                            {% if comment.comments %}
                                                <div class="mt-2">
                                                    <a onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-nested').classList.remove('hidden')" class="text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline">View all {{comment.comments|length}} replies</a>
                                                </div>
                                            {% endif %}
                                            <form class="mt-4 hidden" action="/social/feed/{{post.id}}/comment/{{comment.id}}/comment/" method="POST" id="comments-{{post.id}}-comment-{{comment.id}}-form"> <!-- comment-form-{post.id}-->
                                                {% csrf_token %}
                                                <div class="py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
                                                    <label for="comment" class="sr-only">Your Relpy</label>
                                                    <textarea id="comment" name="content" rows="3"
                                                        class="px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800"
                                                        placeholder="Write a comment..." required></textarea>
                                                </div>
                                                <div class="flex items">
                                                    <button type="submit"
                                                        class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                                                        Post Reply
                                                    </button>
                                                    <button type="button" onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-form').classList.add('hidden')"
                                                        class="text-white bg-red-500 dark:bg-red-600 dark:hover:bg-red-400 focus:ring-2 focus:ring-red-400 font-medium rounded-lg text-sm px-5 py-2.5 flex ms-auto right-0">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </form>
                                        </article>
                                        {% if comment.comments %}
                                            <div class="hidden" id="comments-{{post.id}}-comment-{{comment.id}}-nested">  <!-- nested -->
                                                <div class="flex items-center mx-auto justify-center mb-2">
                                                    <button type="button" onclick="document.getElementById('comments-{{post.id}}-comment-{{comment.id}}-nested').classList.add('hidden')">
                                                        <i class="fa-regular fa-arrow-alt-circle-up fa-2x text-primary-800 dark:text-white"></i>
                                                    </button>
                                                </div>
                                            {% for nested_comment in comment.comments %}
                                                
                                                <article class="p-6 mb-3 ml-6 lg:ml-12 text-base bg-gray-200 rounded-lg dark:bg-gray-700"> <!-- comments-{comment.post.id}-comment-{comment.id}-nested-{comment_nested.id} -->
                                                    <footer class="flex justify-between items-center mb-2">
                                                        <div class="flex items-center">
                                                            <p class="inline-flex items-center mr-3 text-sm text-gray-900 dark:text-white font-semibold">
                                                                {% if nested_comment.user_profile.avatar%}
                                                                    <img
                                                                    class="mr-2 w-6 h-6 rounded-full"
                                                                    src="{{ nested_comment.user_profile.avatar.url }}"
                                                                    alt="Michael Gough">
                                                                {% else %}
                                                                    <img
                                                                        class="mr-2 w-6 h-6 rounded-full"
                                                                        src="{% static "dist/img/default-user.png" %}"
                                                                        alt="Michael Gough">
                                                                {% endif %}
                                                                {{nested_comment.user_profile.user.username}}
                                                            </p>
                                                            <p class="text-sm text-gray-600 dark:text-gray-400"><time pubdate datetime="2022-02-12"
                                                                    title="February 12th, 2022">{{nested_comment.created_at|naturaltime}}</time></p>
                                                        </div>
                                                        <button id="dropdownComment2Button" data-dropdown-toggle="dropdownComment2"
                                                            class="inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 dark:text-gray-40 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                                                            type="button">
                                                            <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                                                                <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                                                            </svg>
                                                            <span class="sr-only">Comment settings</span>
                                                        </button>
                                                        <!-- Dropdown menu -->
                                                        <div id="dropdownComment2"
                                                            class="hidden z-10 w-36 bg-white rounded divide-y divide-gray-100 shadow dark:bg-gray-700 dark:divide-gray-600">
                                                            <ul class="py-1 text-sm text-gray-700 dark:text-gray-200"
                                                                aria-labelledby="dropdownMenuIconHorizontalButton">
                                                                {% if request.user.profile == nested_comment.user_profile or request.user.is_superuser %}
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Edit</a>
                                                                </li>
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Remove</a>
                                                                </li>
                                                                {% endif %}
                                                                <li>
                                                                    <a href="#"
                                                                        class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Report</a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </footer>
                                                    <p class="text-gray-500 dark:text-gray-400">{{ nested_comment.content}}</p>
                                                    <div class="flex items-center mt-4 space-x-4">
                                                        <div class="flex items-center">
                                                            <a href="/social/feed/{{post.id}}/comment/{{nested_comment.id}}/like/" class="flex items-center justify-center w-6 h-6 text-gray-500 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none">
                                                                {% if nested_comment.liked %}
                                                                    <i class="fa fa-heart"></i>
                                                                {% else %}
                                                                    <i class="fa-regular fa-heart"></i> <!--not liked-->
                                                                {% endif %}
                                                            </a>
                                                            <span class="w-1 h-1 mx-1.5 bg-gray-500 rounded-full dark:bg-gray-400"></span>
                                                            <small class="text-sm text-gray-500 dark:text-gray-400 text-medium">{{nested_comment.likes|length}} likes</small>
                                                        </div>
                                                    </div>
                                                </article>
                                            {% endfor %}
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="col-span-1 hidden lg:block h-full">
            <aside id="cta-button-sidebar" onclick="hinge(this)" class="sticky top-0 right-0 z-40 rounded-lg shadow h-fit max-h-full transition-transform -translate-x-full sm:translate-x-0" aria-label="Sidebar" style="top:8rem">
                <div class="h-full px-3 py-4 overflow-y-auto bg-gray-50 dark:bg-gray-800 rounded-lg shadow">
                   <form action="#" method="get" class="z-40 h-full">
                        <h5 id="drawer-label"
                            class="inline-flex items-center mb-4 text-base font-semibold text-gray-500 uppercase dark:text-gray-400">
                            Apply filters
                        </h5>
                        
                    
                        <div class="flex flex-col justify-between flex-1">
                            <div class="space-y-6">
                                <!-- Categories -->
                                <div class="space-y-2">
                                    <h6 class="text-base font-medium text-black dark:text-white">
                                        Fish Species
                                    </h6>
                    
                                    <div class="flex items-center">
                                        <input id="tv" type="checkbox" value=""
                                            class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
                    
                                        <label for="tv" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                            Blue Tang
                                        </label>
                                    </div>
                    
                    
                                    <div class="flex items-center">
                                        <input id="tablet" type="checkbox" value=""
                                            class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
                    
                                        <label for="tablet" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                            Macleay's Glassfish
                                        </label>
                                    </div>
                    
                                    <div class="flex items-center">
                                        <input id="foto" type="checkbox" value=""
                                            class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
                    
                                        <label for="foto" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                            Longspine Glassfish
                                        </label>
                                    </div>
                    
                                    <div class="flex items-center">
                                        <input id="fashion" type="checkbox" value=""
                                            class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
                    
                                        <label for="fashion" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                            Northwest Glassfish
                                        </label>
                                    </div>
                    
                                    <div class="flex items-center">
                                        <input id="books" type="checkbox" value=""
                                            class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" />
                    
                                        <label for="books" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                                            Northern Whiting
                                        </label>
                                    </div>
                    
                                    <a href="#"
                                        class="flex items-center text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline">
                                        View all
                                    </a>
                                </div>
                    
                                <!-- Prices -->
                                <div class="space-y-2">
                                    <h6 class="text-base font-medium text-black dark:text-white">
                                        Likes
                                    </h6>
                                    <div class="flex items-center justify-between col-span-2 space-x-3">
                                        <div class="w-full">
                                            <label for="min-experience-input"
                                                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                                From
                                            </label>
                    
                                            <input type="number" id="price-from" value="300" min="1" max="10000"
                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                                placeholder="" required>
                                        </div>
                    
                                        <div class="w-full">
                                            <label for="price-to"
                                                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                                To
                                            </label>
                    
                                            <input type="number" id="max-experience-input" value="3500" min="1" max="10000"
                                                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                                placeholder="" required>
                                        </div>
                                    </div>
                                </div>
                    
                            </div>
                    
                            <div class="bottom-0 left-0 flex justify-center w-full pb-4 mt-6 space-x-4 md:px-4">
                                <button type="submit"
                                    class="w-full px-5 py-2 text-sm font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                                    Apply filters
                                </button>
                                <button type="reset"
                                    class="w-full px-5 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
                                    Clear all
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </aside>
             
        </div>
    
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>
<script>
    function hinge(element) {
        element.classList += 'animate__animated animate__hinge animate__slower';
        element.addEventListener('animationend', () => {
            element.remove();
        });
    }
</script>
{% endblock %}